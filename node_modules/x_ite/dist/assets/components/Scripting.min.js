/* X_ITE v8.4.3 */(()=>{"use strict";var e={355:e=>{e.exports=window[Symbol.for("X_ITE.X3D-8.4.3")].require("lib/jquery")}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{const e=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Components");var t=i.n(e);const n=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Base/X3DFieldDefinition");var o=i.n(n);const r=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Base/FieldDefinitionArray");var s=i.n(r);const a=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Base/X3DField");var c=i.n(a);const u=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Base/X3DArrayField");var l=i.n(u);const d=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Fields");var p=i.n(d);const f=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Browser/X3DBrowser");var v=i.n(f);const h=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Configuration/ComponentInfo");var S=i.n(h);const _=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Configuration/ComponentInfoArray");var F=i.n(_);const w=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Configuration/ProfileInfo");var g=i.n(w);const y=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Configuration/ProfileInfoArray");var m=i.n(y);const x=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Configuration/UnitInfo");var D=i.n(x);const X=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Configuration/UnitInfoArray");var E=i.n(X);const T=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Execution/X3DExecutionContext");var M=i.n(T);const b=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Execution/X3DScene");var I=i.n(b);const C=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Prototype/ExternProtoDeclarationArray");var O=i.n(C);const A=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Prototype/ProtoDeclarationArray");var q=i.n(A);const N=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Prototype/X3DExternProtoDeclaration");var V=i.n(N);const B=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Prototype/X3DProtoDeclaration");var P=i.n(B);const R=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Routing/RouteArray");var z=i.n(R);const L=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Routing/X3DRoute");var U=i.n(L);const k=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Namespace");var j=i.n(k);const G=function(e,t){return Function(`with (arguments [0])\n   {\n      delete arguments [0];\n      arguments .length = 0;\n      ${t}\n   }`)(e)};j().set("x_ite/Browser/Scripting/evaluate",G);const $=G,H=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Components/Core/X3DChildNode");var J=i.n(H);const W=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Components/Networking/X3DUrlObject");var K=i.n(W);const Q=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/Base/X3DConstants");var Y=i.n(Q);function Z(e){J().call(this,e),K().call(this,e),this.addType(Y().X3DScriptNode)}Z.prototype=Object.assign(Object.create(J().prototype),K().prototype,{constructor:Z,initialize:function(){J().prototype.initialize.call(this),K().prototype.initialize.call(this)},dispose:function(){K().prototype.dispose.call(this),J().prototype.dispose.call(this)}});const ee=Z;j().set("x_ite/Components/Scripting/X3DScriptNode",ee);const te=ee,ie=window[Symbol.for("X_ITE.X3D-8.4.3")].require("x_ite/InputOutput/FileLoader");var ne=i.n(ie),oe=i(355);function re(e){te.call(this,e),this.addType(Y().Script),this.pauseTime=0}re.prototype=Object.assign(Object.create(te.prototype),{constructor:re,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new(s())([new(o())(Y().inputOutput,"metadata",new(p().SFNode)),new(o())(Y().inputOutput,"description",new(p().SFString)),new(o())(Y().inputOutput,"load",new(p().SFBool)(!0)),new(o())(Y().inputOutput,"url",new(p().MFString)),new(o())(Y().inputOutput,"autoRefresh",new(p().SFTime)),new(o())(Y().inputOutput,"autoRefreshTimeLimit",new(p().SFTime)(3600)),new(o())(Y().initializeOnly,"directOutput",new(p().SFBool)),new(o())(Y().initializeOnly,"mustEvaluate",new(p().SFBool))]),getTypeName:function(){return"Script"},getComponentName:function(){return"Scripting"},getContainerField:function(){return"children"},initialize:function(){te.prototype.initialize.call(this);for(const e of this.getUserDefinedFields())e.setModificationTime(0);this.requestImmediateLoad()},getExtendedEventHandling:function(){return!1},canUserDefinedFields:function(){return!0},addUserDefinedField:function(e,t,i){te.prototype.addUserDefinedField.call(this,e,t,i),this.isInitialized()&&(this.setLoadState(Y().NOT_STARTED_STATE),this.requestImmediateLoad())},removeUserDefinedField:function(e){te.prototype.removeUserDefinedField.call(this,e),this.isInitialized()&&(this.setLoadState(Y().NOT_STARTED_STATE),this.requestImmediateLoad())},getSourceText:function(){return this._url},unLoadNow:function(){this.initialize__("")},loadNow:function(){this.initialized=!1,new(ne())(this).loadScript(this._url,function(e){null===e?this.setLoadState(Y().FAILED_STATE):(this.setLoadState(Y().COMPLETE_STATE),this.initialize__(e))}.bind(this))},getContext:function(e){try{const t=["initialize","prepareEvents","eventsProcessed","shutdown"];for(const e of this.getUserDefinedFields())switch(e.getAccessType()){case Y().inputOnly:t.push(e.getName());break;case Y().inputOutput:t.push("set_"+e.getName())}e+="\nreturn ["+t.map((function(e){return`typeof ${e} !== "undefined" ? ${e} : undefined`})).join(",")+"];",this.global=this.getGlobal();const i=$(this.global,e),n={};for(let e=0;e<t.length;++e)n[t[e]]=i[e];return n}catch(e){return this.setError("while evaluating script source",e),{}}},evaluate:function(e){return $(this.global,`return (${e})`)},getGlobal:function(){const e=this.getBrowser(),t=this.getExecutionContext(),i=this.isLive();function n(n){const o=e.createX3DFromString(String(n)),r=o.getRootNodes();if(i.addFieldInterest(o.isLive()),o.setLive(i.getValue()),o.setPrivate(t.isPrivate()),o.setExecutionContext(t),r.length&&r[0])return r[0];throw new Error("SFNode.new: invalid argument, must be 'string' is 'undefined'.")}n.prototype=p().SFNode.prototype;const r={NULL:{value:null},FALSE:{value:!1},TRUE:{value:!0},print:{value:e.println.bind(e)},trace:{value:e.println.bind(e)},Browser:{value:e},X3DConstants:{value:Y()},X3DBrowser:{value:v()},X3DExecutionContext:{value:M()},X3DScene:{value:I()},ComponentInfo:{value:S()},ComponentInfoArray:{value:F()},ProfileInfo:{value:g()},ProfileInfoArray:{value:m()},UnitInfo:{value:D()},UnitInfoArray:{value:E()},ExternProtoDeclarationArray:{value:O()},ProtoDeclarationArray:{value:q()},X3DExternProtoDeclaration:{value:V()},X3DProtoDeclaration:{value:P()},RouteArray:{value:z()},X3DRoute:{value:U()},X3DFieldDefinition:{value:o()},FieldDefinitionArray:{value:s()},X3DField:{value:c()},X3DArrayField:{value:l()},SFColor:{value:p().SFColor},SFColorRGBA:{value:p().SFColorRGBA},SFImage:{value:p().SFImage},SFMatrix3d:{value:p().SFMatrix3d},SFMatrix3f:{value:p().SFMatrix3f},SFMatrix4d:{value:p().SFMatrix4d},SFMatrix4f:{value:p().SFMatrix4f},SFNode:{value:n},SFRotation:{value:p().SFRotation},SFVec2d:{value:p().SFVec2d},SFVec2f:{value:p().SFVec2f},SFVec3d:{value:p().SFVec3d},SFVec3f:{value:p().SFVec3f},SFVec4d:{value:p().SFVec4d},SFVec4f:{value:p().SFVec4f},VrmlMatrix:{value:p().VrmlMatrix},MFBool:{value:p().MFBool},MFColor:{value:p().MFColor},MFColorRGBA:{value:p().MFColorRGBA},MFDouble:{value:p().MFDouble},MFFloat:{value:p().MFFloat},MFImage:{value:p().MFImage},MFInt32:{value:p().MFInt32},MFMatrix3d:{value:p().MFMatrix3d},MFMatrix3f:{value:p().MFMatrix3f},MFMatrix4d:{value:p().MFMatrix4d},MFMatrix4f:{value:p().MFMatrix4f},MFNode:{value:p().MFNode},MFRotation:{value:p().MFRotation},MFString:{value:p().MFString},MFTime:{value:p().MFTime},MFVec2d:{value:p().MFVec2d},MFVec2f:{value:p().MFVec2f},MFVec3d:{value:p().MFVec3d},MFVec3f:{value:p().MFVec3f},MFVec4d:{value:p().MFVec4d},MFVec4f:{value:p().MFVec4f}};for(const e of this.getUserDefinedFields()){const t=e.getName();e.getAccessType()!==Y().inputOnly&&(t in r||(r[t]={get:e.valueOf.bind(e),set:e.setValue.bind(e)}),e.getAccessType()===Y().inputOutput&&(r[t+"_changed"]={get:e.valueOf.bind(e),set:e.setValue.bind(e)}))}return Object.create(Object.prototype,r)},processOutstandingEvents:function(){for(const e of this.getUserDefinedFields())if(!(e.getModificationTime()<=this.pauseTime))switch(e.getAccessType()){case Y().inputOnly:{const t=this.context[e.getName()];"function"==typeof t&&this.set_field__(t,e);break}case Y().inputOutput:{const t=this.context["set_"+e.getName()];"function"==typeof t&&this.set_field__(t,e);break}}},initialize__:function(e){this.context=this.getContext(e),this.set_live__()},set_live__:function(){if(te.prototype.set_live__.call(this),this.context)if(this.isLive().getValue()){if(!this.initialized){if(this.initialized=!0,"function"==typeof this.context.initialize){const e=this.getBrowser();e.getScriptStack().push(this);try{this.context.initialize()}catch(e){this.setError("in function 'initialize'",e)}e.getScriptStack().pop()}"function"==typeof this.context.shutdown&&oe(window).on("unload",this.shutdown__.bind(this))}"function"==typeof this.context.prepareEvents&&this.getBrowser().prepareEvents().addInterest("prepareEvents__",this),"function"==typeof this.context.eventsProcessed&&this.addInterest("eventsProcessed__",this);for(const e of this.getUserDefinedFields())switch(e.getAccessType()){case Y().inputOnly:{const t=this.context[e.getName()];"function"==typeof t&&e.addInterest("set_field__",this,t);break}case Y().inputOutput:{const t=this.context["set_"+e.getName()];"function"==typeof t&&e.addInterest("set_field__",this,t);break}}this.processOutstandingEvents()}else{this.context.prepareEvents&&this.getBrowser().prepareEvents().removeInterest("prepareEvents__",this),this.context.eventsProcessed&&this.removeInterest("eventsProcessed__",this);for(const e of this.getUserDefinedFields())switch(e.getAccessType()){case Y().inputOnly:case Y().inputOutput:e.removeInterest("set_field__",this)}this.initialized&&(this.pauseTime=Date.now())}},prepareEvents__:function(){const e=this.getBrowser();e.getScriptStack().push(this);try{this.context.prepareEvents(e.getCurrentTime()),e.addBrowserEvent()}catch(e){this.setError("in function 'prepareEvents'",e)}e.getScriptStack().pop()},set_field__:function(e,t){const i=this.getBrowser();t.setTainted(!0),i.getScriptStack().push(this);try{e(t.valueOf(),i.getCurrentTime())}catch(e){this.setError("in function '"+t.getName()+"'",e)}i.getScriptStack().pop(),t.setTainted(!1)},eventsProcessed__:function(){const e=this.getBrowser();e.getScriptStack().push(this);try{this.context.eventsProcessed()}catch(e){this.setError("in function 'eventsProcessed'",e)}e.getScriptStack().pop()},shutdown__:function(){const e=this.getBrowser();e.getScriptStack().push(this);try{this.context.shutdown()}catch(e){this.setError("in function 'shutdown'",e)}e.getScriptStack().pop()},setError:function(e,t){console.error("JavaScript Error in Script '"+this.getName()+"', "+e+"\nworld url is '"+this.getExecutionContext().getWorldURL()+"':"),console.error(t)}});const se=re;j().set("x_ite/Components/Scripting/Script",se);const ae=se;t().addComponent({name:"Scripting",types:{Script:ae},abstractTypes:{X3DScriptNode:te}});const ce=void 0;j().set("assets/components/Scripting",ce)})()})();